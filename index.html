<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Sun City Team List</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    /* ====== GLOBAL ====== */
    :root {
      --bg: #000000;
      --gold: #f5a623;
      --white: #ffffff;
      --font-main: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      width: 100%;
      height: 100%;
      background: var(--bg);
      color: var(--white);
      font-family: var(--font-main);
      overflow: hidden;
    }

    body {
      display: flex;
      justify-content: center;
      align-items: center;
    }

    /* ====== CONTAINER (1080x1920) ====== */
    .overlay-root {
      width: 1080px;
      height: 1920px;
      background: var(--bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 40px 60px 40px 60px;
    }

    /* ====== HEADER / LOGO ====== */
    .header {
      width: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 40px;
    }

    .header-logo {
      max-width: 420px;
      height: auto;
    }

    /* ====== TEAM LIST WRAPPER ====== */
    .team-list-wrapper {
      width: 100%;
      flex: 1;
      display: flex;
      flex-direction: column;
      border-radius: 16px;
      border: 1px solid rgba(245, 166, 35, 0.35);
      padding: 24px 32px;
      background: radial-gradient(circle at top, rgba(245, 166, 35, 0.12), transparent 55%);
      overflow: hidden;
    }

    .team-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-bottom: 12px;
      margin-bottom: 12px;
      border-bottom: 1px solid rgba(245, 166, 35, 0.5);
      font-size: 26px;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--gold);
    }

    .team-list-header span {
      font-weight: 600;
    }

    /* ====== SCROLL AREA ====== */
    .team-list-scroll {
      flex: 1;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    /* ====== ROWS ====== */
    .team-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 0;
      border-bottom: 1px solid rgba(255, 255, 255, 0.06);
      font-size: 24px;
      line-height: 1.2;
    }

    .team-row:last-child {
      border-bottom: none;
    }

    .team-name {
      font-weight: 600;
      color: var(--white);
      max-width: 55%;
      text-align: left;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .buyer-name {
      font-weight: 500;
      color: var(--gold);
      max-width: 40%;
      text-align: right;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .buyer-name.empty {
      opacity: 0.35;
      font-style: italic;
    }
  </style>
</head>
<body>
  <div class="overlay-root">
    <!-- HEADER / LOGO -->
    <div class="header">
      <img
        src="<img 
  src="https://raw.githubusercontent.com/thecoder915/overlay-5/main/logo1.PNG"
  alt="Sun City Sports Cards"
  class="header-logo"
/>
"
        alt="Sun City Sports Cards"
        class="header-logo"
      />
    </div>

    <!-- TEAM LIST PANEL -->
    <div class="team-list-wrapper">
      <div class="team-list-header">
        <span>Team</span>
        <span>Buyer</span>
      </div>
      <div id="team-list" class="team-list-scroll">
        <!-- Rows injected by JS -->
      </div>
    </div>
  </div>

  <script>
    const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSln3uXbCr3DlShI6rdJSlD_yhPpJVkzHDH5tvxseNiRhKozLSQmspoSeniTnmtuIyYRm2v3lng2Xac/pub?output=csv";
    const REFRESH_MS = 30000;

    let lastRows = [];

    async function fetchCSV(url) {
      const res = await fetch(url, { cache: "no-store" });
      if (!res.ok) throw new Error("Failed to fetch CSV: " + res.status);
      return await res.text();
    }

    function parseCSV(text) {
      const lines = text.split(/\r?\n/).filter(l => l.trim() !== "");
      if (lines.length === 0) return [];

      const headers = lines[0].split(",").map(h => h.trim().toLowerCase());
      const teamIndex = headers.indexOf("team");
      const buyerIndex = headers.indexOf("buyer");

      const rows = [];

      for (let i = 1; i < lines.length; i++) {
        const cols = lines[i].split(",");
        const team = teamIndex >= 0 ? (cols[teamIndex] || "").trim() : "";
        const buyer = buyerIndex >= 0 ? (cols[buyerIndex] || "").trim() : "";
        if (!team && !buyer) continue;
        rows.push({ team, buyer });
      }

      return rows;
    }

    function updateDOM(rows) {
      const container = document.getElementById("team-list");

      // First load: build everything
      if (container.children.length === 0) {
        rows.forEach((row) => {
          const div = document.createElement("div");
          div.className = "team-row";

          const teamEl = document.createElement("div");
          teamEl.className = "team-name";
          teamEl.textContent = row.team;

          const buyerEl = document.createElement("div");
          buyerEl.className = "buyer-name";
          buyerEl.textContent = row.buyer || "—";
          if (!row.buyer) buyerEl.classList.add("empty");

          div.appendChild(teamEl);
          div.appendChild(buyerEl);
          container.appendChild(div);
        });
        return;
      }

      // Update existing rows without clearing DOM
      rows.forEach((row, i) => {
        const div = container.children[i];
        if (!div) return;

        const teamEl = div.children[0];
        const buyerEl = div.children[1];

        if (teamEl.textContent !== row.team) {
          teamEl.textContent = row.team;
        }

        if (buyerEl.textContent !== (row.buyer || "—")) {
          buyerEl.textContent = row.buyer || "—";
          if (!row.buyer) buyerEl.classList.add("empty");
          else buyerEl.classList.remove("empty");
        }
      });
    }

    async function updateTeamList() {
      try {
        const csvText = await fetchCSV(CSV_URL);
        const rows = parseCSV(csvText);

        if (rows.length === 0) {
          console.warn("Empty CSV — keeping previous list");
          return;
        }

        lastRows = rows;
        updateDOM(rows);

      } catch (err) {
        console.error("Error updating team list:", err);
      }
    }

    updateTeamList();
    setInterval(updateTeamList, REFRESH_MS);
  </script>
</body>
</html>
